- content_for :head_content do
  = javascript_include_tag 'price_group_products'

- content_for :h1 do
  =h current_facility

- content_for :sidebar do
  = render :partial => 'admin/shared/sidenav_product', :locals => { :sidenav_tab => 'instruments' }

- content_for :tabnav do
  = render :partial => 'admin/shared/tabnav_product', :locals => {:secondary_tab => 'pricing_rules'}

%h2=h @product

%p Price groups may or may not be allowed to purchase this product. Use the form below to restrict or authorize purchasing. The reservation window is the number of days in advance a user in the price group may create a reservation.

- form_tag(facility_price_group_product_path(current_facility, @product), :method => :put) do
  %table
    %tr
      %th Price Group (Type)
      %th Reservation Window
      %th Can purchase?
    - @price_groups.each do |price_group|
    - purchasable=can_purchase?(price_group)
      %tr
        %td=h "#{price_group.name} (#{price_group.type_string})"
        %td=text_field_tag "price_group_#{price_group.id}[reservation_window]", purchasable ? reservation_window(price_group) : '', :disabled => !purchasable
        %td=select "price_group_#{price_group.id}", "purchase", [ 'Yes', 'No' ], :selected => purchasable ? 'Yes' : 'No'

  = submit_tag 'Save restrictions', :class => :btn