= will_paginate(@order_details) if @order_details.respond_to? :total_pages
%table.dense
  - if @order_detail_action
    %tr.borderless
      %td{:colspan => (@action_date_field ? 2 : 6)}= link_to 'Select All', '#', :class => 'select_all'
      - if @action_date_field
        %th{:colspan => 2}= @action_date_field.keys.first.to_s.titleize
        %th{:colspan => 2}= text_field_tag @action_date_field.keys.first, @action_date_field.values.first.strftime("%m/%d/%Y"), {:class => 'datepicker'}  
      %td.currency{:colspan => 2}= submit_tag @order_detail_action.to_s.titleize
  %tr
    -if @order_detail_action 
      %th
    - unless single_account?
      %th= Account.model_name.human
    %th Order #
    %th Fulfillment Date
    - unless single_facility?
      %th Facility.model_name.human
    %th Ordered/Reserved By
    %th Description
    %th Cost
    %th Status
    
  - @order_details.each do |order_detail|
    %tr{:class => row_class(order_detail)}
      - if @order_detail_action
        %td= check_box_tag "order_detail_ids[]", order_detail.id, false, {:class => 'toggle'}
      - unless single_account?
        %td= order_detail.account
      %td.nowrap= link_to order_detail, order_order_detail_path(order_detail.order, order_detail) 
      %td= order_detail.fulfilled_at.strftime("%m/%d/%Y") if order_detail.fulfilled_at
      - unless single_facility?
        %td= order_detail.order.facility
      %td= order_detail.order.user.full_name
      %td
        = order_detail.product
        %br
        %em= order_detail.reservation
      %td 
        - if order_detail.cost_estimated?
          %span.estimated_cost
            = show_estimated_total(order_detail)
        - elsif order_detail.price_policy.nil?
          Unassigned
        - else
          %span.actual_cost
            = show_actual_total(order_detail)
      %td= order_detail.order_status
= will_paginate(@order_details) if @order_details.respond_to? :total_pages