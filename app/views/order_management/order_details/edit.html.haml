.modal-header
  = modal_close_button
  %h3= "Order ##{@order_detail} #{@order_detail.product}"

= simple_form_for @order_detail, :url => manage_facility_order_order_detail_path(current_facility, @order, @order_detail), :remote => true do |f|
  .modal-body
    = render :partial => 'warnings'

    = f.association :account, :collection => @available_accounts, :label_method => :account_pretty, :include_blank => false, :disabled => @order_detail.edit_disabled?
    
    
    = f.label :order_status
    - if @order_statuses
      = f.association :order_status, :collection => @order_statuses, :label_method => :name_with_level, :include_blank => false, :label => false
    - else
      = @order_detail.order_status
    - if @order_detail.reservation
      .cancel-fee-option
        = label_tag 'with_cancel_fee' do
          = check_box_tag 'with_cancel_fee', 1, false, :data => { :connect => '#order_detail_order_status_id', :show_on => OrderStatus.cancelled.first.id }
          = t('facility_order_details.edit.label.with_cancel_fee')
          

    - if @order_detail.reservation
      = render :partial => 'reservation', :locals => { :f => f, :reservation => @order_detail.reservation }
    - else
      = f.input :quantity, 
        :input_html => { :class => @order_detail.quantity_as_time? ? 'timeinput' : '' },
        :disabled => !@order_detail.quantity_editable?

    = render :partial => 'costs', :locals => { :f => f }

    = render :partial => 'assigned_user', :locals => { :f => f }

    = f.input :note, :as => :text

  .modal-footer
    = f.submit 'Save', :class => ['btn', 'btn-primary'] unless @order_detail.edit_disabled?
    = modal_cancel_button

  - if @order_detail.edit_disabled?
    :javascript
      $('.edit_order_detail').find('select,textarea,input').prop('disabled', true);